<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <parent>
    <groupId>com.meizu.simplify</groupId>
    <artifactId>config-plugins</artifactId>
    <version>1.2.1-SNAPSHOT</version>
  </parent>
  <artifactId>config-server</artifactId>
  <name>配置服务客户端</name>
  <properties>
  	 <templatePath>${project.parent.basedir}</templatePath>
  	 <parentsite></parentsite>
  </properties>
   <dependencies>
	  <dependency>
	  	<groupId>com.meizu.simplify</groupId>
	    <artifactId>config</artifactId>
	    <version>${parent.version}</version>
	  </dependency>
	  <dependency>
	  	<groupId>com.meizu.simplify</groupId>
	    <artifactId>config-api</artifactId>
	    <version>${parent.version}</version>
	  </dependency>
	  <dependency>
	  	<groupId>com.meizu.simplify</groupId>
	    <artifactId>zookeeper</artifactId>
	    <version>${parent.version}</version>
	  </dependency>
	  <dependency>
	  	<groupId>com.meizu.simplify</groupId>
	    <artifactId>test</artifactId>
	    <version>${parent.version}</version>
	    <scope>test</scope>
	  </dependency>
	  <dependency>
		<groupId>org.slf4j</groupId>
		<artifactId>slf4j-log4j12</artifactId>
		<version>1.7.7</version>
	</dependency>
	<dependency>
		<groupId>log4j</groupId>
		<artifactId>log4j</artifactId>
		<version>1.2.17</version>
	</dependency>
  </dependencies>
  <build>
  	<plugins>
  		<plugin>
			<groupId>org.apache.maven.plugins</groupId>
			<artifactId>maven-jar-plugin</artifactId>
			<configuration>
				<archive>
						<!-- 运行时的jar包，不需要在META-INF中maven目录中有pom*文件 -->
						<addMavenDescriptor>false</addMavenDescriptor>
						<compress>true</compress>
						<forced>true</forced>
						<!-- 包中考虑添加index.list来描述整个分发包的内容 -->
						<!-- 注意：开启这个选项，会在META-INF添加index.list文件，会导致classpath失效，程序无法正常运行，可运行的程序，依赖META-INF的MANIFEST.MF文件的程序，一定不要开启它 -->
						<index>false</index>
			            <manifest>
			              <addClasspath>true</addClasspath>
			              <addDefaultSpecificationEntries>false</addDefaultSpecificationEntries>
			              <addDefaultImplementationEntries>true</addDefaultImplementationEntries>
			              <addExtensions>false</addExtensions>
			              <classpathMavenRepositoryLayout>false</classpathMavenRepositoryLayout>
			              <classpathPrefix></classpathPrefix>
			              <!-- <classpathLayoutType>custom</classpathLayoutType>
			              <customClasspathLayout>path</customClasspathLayout> -->
			              <useUniqueVersions>true</useUniqueVersions>
                          <mainClass>com.meizu.simplify.config.server.bootstrap.Server</mainClass>
			            </manifest>
						<manifestEntries>
							<!-- 增加自定义的classpath -->
							<Class-Path>../</Class-Path>
	               			<!-- <Dependencies>org.javassist, org.apache.velocity</Dependencies> -->
							<artifactId>${project.artifactId}</artifactId>
							<Copyright>meizu 2015</Copyright>
							<!-- <name>${project.name}</name>
							<version>${project.version}</version> 
							<Build-Time>${current.timestamp}</Build-Time>-->
	            		</manifestEntries>
		        		<manifestFile>src/main/resources/META-INF/MANIFEST.MF</manifestFile>
		        		<!-- <pomPropertiesFile>META-INF/maven/${groupId}/${artifactId}/pom.properties</pomPropertiesFile> -->
					</archive>
					<!-- 剥离掉配置信息，会导致加载不到外部配置信息 -->
					<includes>
						<include>**/com/**</include>
					</includes>
				<!-- <skip>true</skip> -->
			</configuration>
		</plugin>
  		<!-- 是maven中针对打包任务而提供的标准插件 -->
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-assembly-plugin</artifactId>
				<version>2.4</version>
				<configuration>
					<!-- <outputFileNameMapping>@{artifactId}@. @{extension}@. @{version}@</outputFileNameMapping> -->
					<finalName>${project.artifactId}</finalName>
					<descriptors>
						<descriptor>src/main/assemblies/bin.xml</descriptor>
					</descriptors>
			        <!-- <encoding>utf-8</encoding> -->
			        <!-- <appendAssemblyId>false</appendAssemblyId>  --> 
			        <!-- <descriptorRefs>
	                    <descriptorRef>jar-with-dependencies</descriptorRef>  
	                </descriptorRefs>  -->
				</configuration>
				<executions>
					<!--执行器 mvn assembly:src-->
					<!--执行器 mvn assembly:bin-->
					<!-- 生成bin安装程序 -->
		            <execution>
			            <id>bin</id>
			            <phase>package</phase><!-- 绑定到package生命周期阶段上 -->
			            <goals>
			            	<!-- <goal>single</goal> --><!-- 只运行一次  --> 
			              <goal>attached</goal>
			            </goals>
			            <configuration>
			              <!-- <archiverConfig>
						        <encoding>utf-8</encoding>
						    </archiverConfig> -->
			              <tarLongFileMode>gnu</tarLongFileMode>
			            </configuration>
		          	</execution>
		          	<!-- 生成源码包 -->
		          	<execution>
			            <id>src</id>
			            <phase>package</phase><!-- 绑定到package生命周期阶段上 -->
			            <goals>
			            	<!-- <goal>single</goal> --><!-- 只运行一次  --> 
			              <goal>attached</goal>
			            </goals>
			            <configuration>
			              <descriptors><!--描述文件路径-->  
		                	<descriptor>src/main/assemblies/src.xml</descriptor>
		              	  </descriptors>
			              <!-- <archiverConfig>
						        <encoding>utf-8</encoding>
						    </archiverConfig> -->
			              <tarLongFileMode>gnu</tarLongFileMode>
			            </configuration>
		          	</execution>
				</executions>
			  	<dependencies>
			          <dependency>
			              <groupId>org.codehaus.plexus</groupId>
			              <artifactId>plexus-archiver</artifactId>
			              <version>2.4.4</version>
			              <exclusions>
			                  <exclusion>
			                      <groupId>org.codehaus.plexus</groupId>
			                      <artifactId>plexus-component-api</artifactId>
			                  </exclusion>
			              </exclusions>
			          </dependency>
			     </dependencies>
			</plugin>
  	</plugins>
  </build>
</project>